<!DOCTYPE html>
<html>
<head>
    <title>T & H Car Rental Service</title>
    <meta charset="utf-8" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

    <style>
        .modal {
            display: none;
            position: relative;
            z-index: 1;
            padding-top: 100px;
            left: 0;
            top: 0;
            width: 50%;
            height: 30%;
        }

        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            height: 80%;
        }

        .close {
            color: #aaaaaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

            .close:hover,
            .close:focus {
                color: #000;
                text-decoration: none;
                cursor: pointer;
            }
    </style>

</head>
<body>
    <h1 style="text-align:center">T & H Car Rental</h1><br /><br />
    
    <!--Pops Open 'Add Car' Modal-->
    <button id="addModal">Add New Car</button>
    <!--Add Car Modal-->
    <div id="addCarModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <table>
                <tr>
                    <td>Enter Vin: </td>
                    <td><input id="txtVin" type="text" /></td>
                </tr>
                <tr>
                    <td>Enter Make: </td>
                    <td><input id="txtMake" type="text" /></td>
                </tr>
                <tr>
                    <td>Enter Model: </td>
                    <td><input id="txtModel" type="text" /></td>
                </tr>
                <tr>
                    <td>Enter Year: </td>
                    <td><input id="txtYear" type="text" /></td>
                </tr>
                <tr>
                    <td>Enter Type: </td>
                    <td><input id="txtType" type="text" /></td>
                </tr>
                <tr>
                    <td>Enter Price Per Day: </td>
                    <td><input id="txtPricePerDay" type="text" /></td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input id="storeCar" value="Store Car" type="button" />
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <!--Add Car Modal Script-->
    <script>
        var modal = document.getElementById('addCarModal');
        var btnAddModal = document.getElementById("addModal");
        var span = document.getElementsByClassName("close")[0];
        // When the user clicks the button, open the modal
        btnAddModal.onclick = function () {
            modal.style.display = "block";
        }
        // When the user clicks on x, close the modal
        span.onclick = function () {
            modal.style.display = "none";
        }


        // Uses WebService to store car info in database
        $("#storeCar").click(function () {
            
            var strURL = "CarService.asmx/StoreCar";    // URL of the Web Service followed by the name of the Web Method
            var Vin = $("#txtVin").val();
            var Make = $("#txtMake").val();
            var Model = $("#txtModel").val();
            var Year = $("#txtYear").val();
            var Type = $("#txtType").val();
            var PricePerDay = $("#txtPricePerDay").val();

            // The input parameters names must match the Web Method parameter names.
            // Create a JavaScript object with properties that have the same names 
            // as the Web Method parameters, and assign the properties values coming from the form controls.
            var Car = new Object();
            Car.Vin = Vin;
            Car.Make = Make;
            Car.Model = Model;
            Car.Year = Year;
            Car.Type = Type;
            Car.PricePerDay = PricePerDay;
            Car.Availability = "true";

            var inputParametersObject = new Object();
            inputParametersObject.carObj = Car;


            // Convert the JavaScript object into a JSON string (serialization).
            inputParams = JSON.stringify(inputParametersObject);
            
            // Make an AJAX request and display the response in the appropriate div.
            $.ajax({
                type: "POST",
                url: strURL,
                contentType: "application/json; charset=utf-8", // set the data type sent to the Web Service
                dataType: "json",                               // set the data type expected from the Web Service                                 
                data: inputParams,                              // send an empty JSON object (no input required).    
                success: function (data) {                      // set callback function used to update the page
                    $("#display").text(data.d);                 // JQuery puts the object returned by the Web Method in data.d
                },
                error: function (req, status, error) {          // sets the error callback function used when an error occurs.
                    alert("Error: " + req.responseText + " | " + status + " | " + error);
                }

            }); //end of ajax method
            // close modal
            modal.style.display = "none";
        }); // end of click event

        



    </script>

</body>
</html>
